---
title: "Benchmarking the accuracy of multiple systems estimation for the quantification of modern slavery"
author: "George Lindner, Morris Greenberg, Pierre Gardan and Olivier Binette"
date: 'December 14, 2019'
runtime: shiny
output:
  html_document:
    includes:
      before_body: html/header.html
    code_folding: hide
    df_print: paged
    theme: flatly
    toc: true
    number_sections: false
    toc_depth: 2
    toc_float: 
      collapsed: true
---

```{r, echo=FALSE, message = FALSE}
if(!require(pacman)){install.packages("pacman")}
pacman::p_load("shiny", "shinycssloaders", "knitr", "kableExtra", 
               "tidyverse", "dga", "MCMCpack", "Rcapture", "LCMCR",
               "UpSetR", "DT", "ggplot2", "cowplot", "resample", 
               "pbapply", "parallel")

source("../input/silverman_code/datasets.R")
source("../input/silverman_code/functions.R")
```

# 1. Introduction

Forty million people currently live in slavery, according to the International Labour Organization (ILO) [most recent estimate](https://www.ilo.org/global/publications/books/WCMS_575479/lang--en/index.htm). In other words, about every 1 in 220 person worldwide is trapped in a situation of "forced labour, forced marriage, or under another form of exploitation that a person cannot refuse or leave because of threats, violence, coercion, deception and/or abuse of power". **Modern slavery** is an umbrella term which broadly refers to such forms of slavery that are currently happening. 

The scale of the problem has prompted the United Nations to add, in 2015, the eradication of modern slavery as part of its [Sustainable Development Goals framework](https://sustainabledevelopment.un.org/). This calls for integrated action to end modern slavery and for the development of reliable statistical indicators. 

> "Take immediate and effective measures to eradicate forced labour, end modern slavery and human trafficking and secure the prohibition and elimination of the worst forms of child labour, including recruitment and use of child soldiers, and by 2025 end child labour in all its forms." (*Target 8.7 of UN's Sustainable Development goals.*)


<!--
However, statistical methodology to estimate the number of undetected victims of modern slavery is still in development. Victims of modern slavery are often hidden, making reliable estimates of the number of victims particularly challenging to develop.
-->

## 1.1. The case of the UK

The United Kingdom's quantification of modern slavery, together with their 2015 Modern Slavery Act, has drawn considerable attention to such efforts. [Silverman (2014)](https://www.gov.uk/government/publications/modern-slavery-an-application-of-multiple-systems-estimation); [Bales et al. (2015)](https://rss.onlinelibrary.wiley.com/doi/full/10.1111/j.1740-9713.2015.00824.x) estimated between 10,000 to 13,000 potential victims using a method called **Multiple Systems Estimation** (MSE). The method aggregates data from multiple sources, such as the police and non-governmental organizations, and estimates the proportion of victims that have not been seen by any of them.

However, follow-up research has shown high sensitivity of the estimates to modelling assumptions, with the Walk Free Foundation providing an [about 10-fold larger estimate](https://downloads.globalslaveryindex.org/ephemeral/GSI-2018_FNL_190828_CO_DIGITAL_P-1576254958.pdf) of about 136 000 victims and a recent analysis [(Whitehead et al., 2019)](https://www.tandfonline.com/doi/abs/10.1080/23322705.2019.1660952?journalCode=uhmt20) even suggesting to abandon attempts at measuring this hidden population. It is unclear if the assumptions underlying standard use of MSE were satisfied in Silverman's study and we are concerned by these developments. MSE methods are used in many sensitive human rights applications and their correct usage is critical to reach truth and maintain credibility. 

## 1.2. Our benchmark

We provide some of the tools necessary to investigate the accuracy and stability of MSE estimates in application to the quantification of modern slavery. Precisely, this interactive document (Section 3) allows to:

1. omit or merge sources of information about potential victims and see the effect on the estimates;
2. estimate the coverage of confidence intervals reported by [Silverman (2014)](https://www.gov.uk/government/publications/modern-slavery-an-application-of-multiple-systems-estimation) through a parametric Bootstrap; and
3. simulate data for a range of realistic model and assess the accuracy of MSE in this context. 

We provide an introduction to MSE in Section 2, the tool is embedded in Section 3 and we sumarize our results in Section 4.

# 2. Multiple systems estimation for the quantification of modern slavery

Multiple systems estimation, also called capture-recapture, is a method which combines multiple sources of information to estimate the size of hidden populations. 
For example, imagine we are trying to estimate the number of fish in a large pond. It is not possible to enumerate all fish, but we are able to take random samples with replacements. A strategy to get an estimate of the unknown total population $N$ is the following:

1. mark a first sample of fish, of size $N_1$, and release them back;
2. take a second sample of fish, of size $N_2$, and count the overlap $m$ with the first sample.

We then have observed a proportion $m/N_1$ of the fish in the first sample. Extrapolating, we assume that our sample of size $N_2$ represents a proportion $m/N_1$ of the total population size $N$. Rearranging the terms, this gives an estimate $\hat{N} = N_1 N_2 / m$.

In the context of modern slavery, the samples are obtained by **organizations** observing **potential victims** and recording the information in **lists**. In Silverman's (2014) study, the data recording observed potential victims is considered in six lists: local authorities (LA), non-government organisations (NG), police forces (PF), government organisations (GO), general public (GP), and national crime agency (NCA).

The overlap between the lists has been computed by a trusted analyst, and the data is summarized below. The rows represent inclusion paterns and the associated count. For instance, the first row, with a "1" under the list LA and with "0" under all other lists, states that exactly 54 potential victims have been observed by local authorities (LA) and by no one else. The row with "1" under both LA and NG, with "0" under other lists, counts individuals recorded by both LA and NG, and by no one else. Using these counts for all possible pattern of overlaps, multiple systems estimation provides an estimate of the total population size, including unobserved  potential victims.

```{r, fig.align="center"}
# HTML rendering of the `UKdat` table.
knitr::kable(UKdat) %>% 
  kable_styling(full_width=FALSE, position="center") %>% 
  scroll_box(height = "200px", width="500px") %>% 
  footnote("The data are considered in six lists, labelled as follows:  LA--Local authorities; NG--Non-government organisations; PF--Police forces; GO--Government organisations; GP--General public; NCA--National Crime Agency.", footnote_as_chunk=T)
```

This data is also plotted below, showing the counts for all observed inclusion patterns.

```{r}
plot_MSE_counts <- function(data, ...) {
  n = ncol(data) - 1
  dat = uncount(data[, 1:n], data$count)
  upset(dat, nsets=n, ...)
}

plot_MSE_counts(UKdat, 
                sets.bar.color = "cornflowerblue",
                main.bar.color = "cornflowerblue",
                matrix.color = "cornflowerblue",
                mainbar.y.label = "Potential victims count",
                sets.x.label = "")
```

## Underlying assumptions

In its simplest form, MSE makes a number of assumptions:

1. *Independence:* the lists are independent from one another.
2. *Homogeneity:* on a given list, all the individuals have the same probability of being recorded.
3. *Closed population:* the population size does not change during the study.
4. *Perfect matching:* the overlap between lists is computed without any error.

These are very restrictive and unlikely to be satisfied in reality. Fortunately, we can account for dependence between the lists by also modelling and estimating interaction terms. This is done through the use of a log-linear model with interactions terms.

## Log-linear model

Precisely, for every lists subset $A \subset \{\text{LA}, \text{NG}, \text{PF}, \text{GO}, \text{GP}, \text{NCA}\}$, we model the count $N_A$ of individuals observed on lists in $A$ and on no other lists as
$$
  N_A \sim \text{Poisson}\left(\exp\left( \mu + \sum_{i \in A} \alpha_i + \sum_{i,j\in A,\,i\not = j} \lambda_{i,j} \right)\right).
$$
The parameters $\alpha_i$ are main effects and the $\lambda_{i,j}$ are interaction terms. In particular, the number of *unobserved victims* which we are interested about is
$$
  N_\emptyset \sim \text{Poisson}(\exp(\mu)), \quad \mathbb{E}[N_\emptyset] = \exp(\mu).
$$

This log-linear Poisson count model is an approximation to a multinomial model and the parameters can be interpreted in term of joint list inclusion probabilities, although this level of detail is not necessary for our purpose.

## Silverman's (2014) `MSEfit` function



# 3. Benchmark {.tabset}

## Data manipulation

```{r}
shinyAppFile("data_application/shiny.R", options = list(
    width = "100%", height = 600
  ))
```

## Bootstrap simulation

```{r}
shinyAppFile("simulation/shiny2.R", options = list(
    width = "100%", height = 550
  ))
```

## Generative models

```{r}
shinyAppFile("generative/shiny.R", options = list(
    width = "100%", height = 1400
  ))
```

# 4. Conclusions



